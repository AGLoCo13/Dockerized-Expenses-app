{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import'bootstrap/dist/css/bootstrap.min.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function TenantPayments(){const[apartmentData,setApartmentData]=useState(null);const[userData,setUserData]=useState(null);const[tenantPayments,setTetantPayments]=useState(null);useEffect(()=>{fetchUserApartmentPaymentsData();},[]);//Function that fetches tenant's profile , the apartment he's tenant to and the payments that are created by the building administrator.\nconst fetchUserApartmentPaymentsData=async()=>{try{//Get the token from local storage \nconst token=window.localStorage.getItem('token');//Fetch the user's profile data from the server with the token in the headers \n//Fetch the user's profile data from the server \nconst response=await axios.get('/api/profile',{headers:{Authorization:\"\".concat(token)}});setUserData(response.data);//Fetch apartment based on the user's profile (tenant ID)\nconst apartmentResponse=await axios.get(\"/api/apartment/\".concat(response.data.profileId),{headers:{Authorization:\"\".concat(token)}});setApartmentData(apartmentResponse.data);console.log(apartmentResponse.data);//Fetch payments created by the building administrator and tied to the specific apartment\nconst paymentResponse=await axios.get(\"/api/payments/\".concat(apartmentResponse.data._id));setTetantPayments(paymentResponse.data);}catch(error){console.error('Error fetching user data:',error);}};{/*From the fetched payments for the apartment , i created a getTotalCosts that gets \n all the payments and sums into a grandTotal in order for the Tenant to see\nhis total cost */}const getTotalCosts=payments=>{let totalHeating=0;let totalElevator=0;let totalGeneral=0;payments.forEach(payment=>{totalHeating+=payment.total_heating;totalElevator+=payment.total_elevator;totalGeneral+=payment.total_general;});return{totalHeating,totalElevator,totalGeneral,grandTotal:totalHeating+totalElevator+totalGeneral};};const totals=tenantPayments?getTotalCosts(tenantPayments):null;return/*#__PURE__*/_jsxs(\"div\",{className:\"container mt-5\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Your Payments\"}),tenantPayments?/*#__PURE__*/_jsxs(\"table\",{className:\"table table-stripped\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Apartment Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Month\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Year\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Heating\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Elevator\"}),/*#__PURE__*/_jsx(\"th\",{children:\"General\"}),/*#__PURE__*/_jsx(\"th\",{children:\" Grand Total\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Payment Made\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:tenantPayments.map(payment=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:apartmentData.name}),/*#__PURE__*/_jsx(\"td\",{children:payment.month}),/*#__PURE__*/_jsx(\"td\",{children:payment.year}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",totals.totalHeating.toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",totals.totalElevator.toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",totals.totalGeneral.toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",totals.grandTotal.toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{children:payment.payment_made?'Yes':'No'})]},payment._id))})]}):/*#__PURE__*/_jsx(\"p\",{children:\" Loading payments...\"})]});}export default TenantPayments;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","TenantPayments","apartmentData","setApartmentData","userData","setUserData","tenantPayments","setTetantPayments","fetchUserApartmentPaymentsData","token","window","localStorage","getItem","response","get","headers","Authorization","concat","data","apartmentResponse","profileId","console","log","paymentResponse","_id","error","getTotalCosts","payments","totalHeating","totalElevator","totalGeneral","forEach","payment","total_heating","total_elevator","total_general","grandTotal","totals","className","children","map","name","month","year","toFixed","payment_made"],"sources":["/home/tonyg/Node-React.js-Expenses-Application/frontend/src/components/TenantPayments.js"],"sourcesContent":["import React , {useState , useEffect } from 'react'\nimport axios from 'axios';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nfunction TenantPayments() {\nconst [apartmentData , setApartmentData] = useState(null);\nconst [userData , setUserData] = useState(null);\nconst [tenantPayments , setTetantPayments] = useState(null);\n\n\n\n\n\n\nuseEffect(() => {\n    fetchUserApartmentPaymentsData();\n}, []);\n\n//Function that fetches tenant's profile , the apartment he's tenant to and the payments that are created by the building administrator.\nconst fetchUserApartmentPaymentsData = async () => {\n    try{\n        //Get the token from local storage \n        const token = window.localStorage.getItem('token');\n        //Fetch the user's profile data from the server with the token in the headers \n        //Fetch the user's profile data from the server \n        const response = await axios.get('/api/profile', {\n            headers: {\n                Authorization : `${token}`,\n            },\n        });\n        setUserData(response.data);\n\n        //Fetch apartment based on the user's profile (tenant ID)\n        const apartmentResponse = await axios.get(`/api/apartment/${response.data.profileId}`,{\n            headers : {\n                Authorization : `${token}` , \n            },\n        });\n        setApartmentData(apartmentResponse.data);\n        console.log(apartmentResponse.data);\n\n        //Fetch payments created by the building administrator and tied to the specific apartment\n        const paymentResponse = await axios.get(`/api/payments/${apartmentResponse.data._id}`)\n        setTetantPayments(paymentResponse.data);\n    }catch(error) {\n        console.error('Error fetching user data:' , error);\n    }\n\n};\n {/*From the fetched payments for the apartment , i created a getTotalCosts that gets \n all the payments and sums into a grandTotal in order for the Tenant to see\nhis total cost */}\n \nconst getTotalCosts = (payments) => {\n    let totalHeating = 0;\n    let totalElevator = 0;\n    let totalGeneral = 0;\n\n\npayments.forEach(payment => {\n    totalHeating += payment.total_heating;\n    totalElevator += payment.total_elevator;\n    totalGeneral += payment.total_general;\n});\n\nreturn {\n    totalHeating,\n    totalElevator,\n    totalGeneral,\n    grandTotal : totalHeating + totalElevator + totalGeneral\n};\n}\n\n  const totals = tenantPayments ? getTotalCosts(tenantPayments) : null;\n  return (\n    <div className='container mt-5'>\n        <h2>Your Payments</h2>\n        {tenantPayments ? (\n            <table className='table table-stripped'>\n                <thead>\n                    <tr>\n                        <th>Apartment Name</th>\n                        <th>Month</th>\n                        <th>Year</th>\n                        <th>Heating</th>\n                        <th>Elevator</th>\n                        <th>General</th>\n                        <th> Grand Total</th>\n                        <th>Payment Made</th>\n                    </tr>\n                </thead>\n            <tbody>\n                {tenantPayments.map(payment => (\n                    <tr key={payment._id}>\n                        <td>{apartmentData.name}</td>\n                        <td>{payment.month}</td>\n                        <td>{payment.year}</td>\n                        <td>${totals.totalHeating.toFixed(2)}</td>\n                        <td>${totals.totalElevator.toFixed(2)}</td>\n                        <td>${totals.totalGeneral.toFixed(2)}</td>\n                        <td>${totals.grandTotal.toFixed(2)}</td>\n                        <td>{payment.payment_made ? 'Yes' : 'No'}</td>\n                    </tr>\n                ))}\n            </tbody>\n            </table>\n        ) : (\n            <p> Loading payments...</p>\n        )}\n      \n    </div>\n  )\n  }\n\nexport default TenantPayments;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}