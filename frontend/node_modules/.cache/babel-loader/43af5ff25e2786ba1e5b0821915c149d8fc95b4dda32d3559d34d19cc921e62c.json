{"ast":null,"code":"import React,{useState}from'react';import axios from'axios';import'bootstrap/dist/css/bootstrap.min.css';import'../css/loginPage.css';import jwtDecode from'jwt-decode';import buildingImg from'../assets/buildingImage.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function LoginPage(){const[email,setEmail]=useState('');const[password,setPassword]=useState('');//Error state\nconst[error,setError]=useState('');const handleEmailChange=e=>{setEmail(e.target.value);};const handlePasswordChange=e=>{setPassword(e.target.value);};const handleSubmit=async e=>{e.preventDefault();setError('');try{const response=await axios.post('http://localhost:5000/api/login',{email,password});// Clear the form fields\nsetEmail('');setPassword('');const{token}=response.data;//Decode the token to get the payload\nconst decodedToken=jwtDecode(token);console.log(decodedToken);//Get the user's role from the decoded token \nconst userRole=decodedToken.role;//Store the token in local storage\nwindow.localStorage.setItem('token',token);//Redirect based on the user's role\nif(userRole==='Site-admin'){window.location.href='/admin-dashboard';}else if(userRole==='Administrator'){window.location.href='/building-administrator';}else if(userRole==='Tenant'){window.location.href='/tenant-dashboard';}}catch(error){if(error.response&&error.response.status===401){setError('Invalid email or password');}else{setError('An error occured. Please try again later');}console.error(error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"login-page d-flex justify-content-center align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row no-gutters\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsx(\"img\",{src:buildingImg,alt:\"Building image\",clasName:\"img-fluid\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"login-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Welcome to the RN-Expenses App!\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Please login with the credentials given to you by the site admin.\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",id:\"email\",value:email,onChange:handleEmailChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",id:\"password\",value:password,onChange:handlePasswordChange})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:\"Login\"})]})]})]});}export default LoginPage;","map":{"version":3,"names":["React","useState","axios","jwtDecode","buildingImg","jsx","_jsx","jsxs","_jsxs","LoginPage","email","setEmail","password","setPassword","error","setError","handleEmailChange","e","target","value","handlePasswordChange","handleSubmit","preventDefault","response","post","token","data","decodedToken","console","log","userRole","role","window","localStorage","setItem","location","href","status","className","children","src","alt","clasName","onSubmit","htmlFor","type","id","onChange"],"sources":["/home/tonyg/Node-React.js-Expenses-Application/frontend/src/components/LoginPage.js"],"sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport '../css/loginPage.css';\nimport jwtDecode from 'jwt-decode';\nimport buildingImg from '../assets/buildingImage.png';\n\nfunction LoginPage() {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  //Error state\n  const [error , setError] = useState(''); \n\n  const handleEmailChange = (e) => {\n    setEmail(e.target.value);\n  };\n\n  const handlePasswordChange = (e) => {\n    setPassword(e.target.value);\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n\n    try {\n      const response = await axios.post('http://localhost:5000/api/login', {email, password});\n        // Clear the form fields\n        setEmail('');\n        setPassword('');\n      const {token} = response.data;\n\n      //Decode the token to get the payload\n      const decodedToken = jwtDecode(token);\n      console.log(decodedToken);\n      //Get the user's role from the decoded token \n      const userRole = decodedToken.role;\n      //Store the token in local storage\n      window.localStorage.setItem('token' , token);\n      //Redirect based on the user's role\n      if (userRole === 'Site-admin') {\n        window.location.href = '/admin-dashboard';\n      }else if(userRole === 'Administrator') {\n        window.location.href = '/building-administrator';\n      }else if (userRole === 'Tenant') {\n        window.location.href = '/tenant-dashboard';\n      }\n    } catch (error) {\n      if(error.response && error.response.status === 401){\n         setError('Invalid email or password');\n      }else{\n      setError('An error occured. Please try again later')\n    }\n    console.error(error);\n  }\n  };\n\n  return (\n    <div className=\"login-page d-flex justify-content-center align-items-center\">\n      <div className='row no-gutters'>\n        <div className='col-md-6'>\n          <img src={buildingImg} alt=\"Building image\" clasName=\"img-fluid\" />\n        </div>\n      </div>\n      <div className=\"login-container\">\n        <h2>Welcome to the RN-Expenses App!</h2>\n        <p>Please login with the credentials given to you by the site admin.</p>\n        <form onSubmit={handleSubmit}>\n          <div className=\"form-group\">\n            <label htmlFor=\"email\">Email:</label>\n            <input\n              type=\"email\"\n              className=\"form-control\"\n              id=\"email\"\n              value={email}\n              onChange={handleEmailChange}\n            />\n          </div>\n          <div className=\"form-group\">\n            <label htmlFor=\"password\">Password:</label>\n            <input\n              type=\"password\"\n              className=\"form-control\"\n              id=\"password\"\n              value={password}\n              onChange={handlePasswordChange}\n            />\n          </div>\n          {error && <div className=\"alert alert-danger\">{error}</div>}\n          <button type=\"submit\" className=\"btn btn-primary\">Login</button>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport default LoginPage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}